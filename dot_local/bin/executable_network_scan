#!/bin/bash

# Perform nmap scan to get hostnames and IP addresses
nmap_output=$(sudo nmap -sP 10.66.1.0/24)

# Perform arp-scan to get MAC addresses
arp_output=$(sudo arp-scan --localnet)

# Parse and combine the results
echo "IP Address | Hostname | MAC Address | OUI"
echo "-----------------------------------------"

while read -r line; do
    if [[ $line == *"Nmap scan report for"* ]]; then
        ip=$(echo $line | awk '{print $5}')
        hostname=$(echo $line | awk '{print $6}' | tr -d '()')
    elif [[ $line == *"MAC Address:"* ]]; then
        mac=$(echo $line | awk '{print $3}')
        oui=$(echo $line | awk '{print $4, $5, $6, $7, $8}')
        echo "$ip | $hostname | $mac | $oui"
    fi
done <<< "$nmap_output"

while read -r line; do
    if [[ $line == *"10.66.1."* ]]; then
        ip=$(echo $line | awk '{print $1}')
        mac=$(echo $line | awk '{print $2}')
        oui=$(echo $line | awk '{print $3, $4, $5, $6, $7}')
        echo "$ip | | $mac | $oui"
    fi
done <<< "$arp_output"
